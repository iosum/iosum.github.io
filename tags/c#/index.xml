<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>c# on Casey's Blog</title><link>https://caseyho.dev/tags/c#/</link><description>Recent content in c# on Casey's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 24 Oct 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://caseyho.dev/tags/c#/index.xml" rel="self" type="application/rss+xml"/><item><title>Dynamic Type 介紹 | c#</title><link>https://caseyho.dev/post/2022-10-24-dynamic-type-in-c-sharp/</link><pubDate>Mon, 24 Oct 2022 00:00:00 +0000</pubDate><guid>https://caseyho.dev/post/2022-10-24-dynamic-type-in-c-sharp/</guid><description>前情提要 在 C# 4.0，有一個新的 Type 叫做 Dynamic Type。
Dynamic Type 不會在 compile time 做 checking，而是在 runtime 的時候編譯器才會知道該變數的 type ，並在 runtime 做 checking。
須注意事項 在大多數的時候，可以把 dynamic type 視為 object。 如果想要知道該變數在 runtime 的 type，可以使用 GetType()。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 using System; public class Program { public static void Main() { dynamic a = &amp;#34;this is a string&amp;#34;; dynamic b = 123234; Console.</description></item><item><title>檢查 date 是否為 null | c#</title><link>https://caseyho.dev/post/2022-10-24-check-date-is-null-date/</link><pubDate>Mon, 24 Oct 2022 00:00:00 +0000</pubDate><guid>https://caseyho.dev/post/2022-10-24-check-date-is-null-date/</guid><description>Snippet 1 2 3 4 if (!datetime.HasValue) { //unassigned } 參考資料 [Checking to see if a DateTime variable has had a value assigned</description></item><item><title>The contextual keyword 'var' may only appear within a local variable declaration. | c#</title><link>https://caseyho.dev/post/2022-10-21-the-contextual-keyword-var-may-only-appear-within-a-local-variable-declaration/</link><pubDate>Wed, 19 Oct 2022 00:00:00 +0000</pubDate><guid>https://caseyho.dev/post/2022-10-21-the-contextual-keyword-var-may-only-appear-within-a-local-variable-declaration/</guid><description>錯誤訊息 The contextual keyword &amp;lsquo;var&amp;rsquo; may only appear within a local variable declaration.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 using System; using System.Collections.Generic; using System.Web; using System.Text; using WebMatrix.Data; /// &amp;lt;summary&amp;gt; /// Summary description for ClassName /// &amp;lt;/summary&amp;gt; public class Base { public void CalculateTotalPriceInCart(var PartNumber, var Description, var OrderId, bool IsBoxed) { var database = Database.</description></item><item><title>保留原本 C# 的 Exception message，並加上客製化 Exception Message | c#</title><link>https://caseyho.dev/post/2022-10-19-add-a-message-to-an-exception-without-losing-any-information-in-c-sharp/</link><pubDate>Wed, 19 Oct 2022 00:00:00 +0000</pubDate><guid>https://caseyho.dev/post/2022-10-19-add-a-message-to-an-exception-without-losing-any-information-in-c-sharp/</guid><description>假設現在程式拋出了一個 Exception，那麼我們看到的訊息應該會是 C# 預設寫好的錯誤訊息，但同時我們希望使用者需要知道這一個錯誤訊息，開發者應該可以將預設寫好的錯誤訊息變成使用者看得懂的東西。此時可以使用 Exception 的 Data 屬性。
Data 屬於 key/value pair，可以傳入自己想要的 key 和 value，可以使用以下 Exception.Data[key] 取到 Value。
範例 1 2 3 4 5 catch (Exception ex) { ex.Data.Add(&amp;#34;UserMessage&amp;#34;, &amp;#34;An error occurred while trying to load the XSLT file.&amp;#34;); throw; } 1 2 3 4 5 6 7 8 9 10 11 catch (Exception ex) { if (ex.Data.Contains(&amp;#34;UserMessage&amp;#34;)) { MessageBox.Show(ex.Data[&amp;#34;UserMessage&amp;#34;].ToString()); } else { MessageBox.Show(ex.Message); } } 參考資料 How can I add a message to an exception without losing any information in C#?</description></item><item><title>web.config 無法存檔，跳出另存新檔視窗 | c#</title><link>https://caseyho.dev/post/2022-09-22-webconfig-cant-save/</link><pubDate>Thu, 22 Sep 2022 23:00:00 +0800</pubDate><guid>https://caseyho.dev/post/2022-09-22-webconfig-cant-save/</guid><description>問題：
當 web.config 需要存檔時，會跳出另存新檔的視窗，且再存檔時，會跳出「由於另一個處理序正在使用檔案」。
解決方案：
開啟工作管理員， 將 Microsoft.VisualStudio.Web.Host.exe 結束工作即可。</description></item><item><title>未設定所要求 URL 的預設文件，且未在伺服器上啟用瀏覽目錄 | c#</title><link>https://caseyho.dev/post/2022-09-22-enable-directory-browsing-by-default-on-iis-express/</link><pubDate>Thu, 22 Sep 2022 23:00:00 +0800</pubDate><guid>https://caseyho.dev/post/2022-09-22-enable-directory-browsing-by-default-on-iis-express/</guid><description>問題：
未設定所要求 URL 的預設文件，且未在伺服器上啟用瀏覽目錄。
解決方法：
其實下面有提示解決方法，「確認網站或應用程序配置文件中的 configuration/system.webServer/directoryBrowse@enabled 屬性已設置為 true。」
實際的運作：
在專案中打開 web.config 檔案 將&amp;lt;system.webServer&amp;gt;加入 web.config 並將以下 2 個 tag 寫入&amp;lt;system.webServer&amp;gt;裡面 &amp;lt;directoryBrowse enabled=&amp;quot;true&amp;quot; /&amp;gt;
&amp;lt;modules runAllManagedModulesForAllRequests=&amp;quot;true&amp;quot; /&amp;gt;
更正後的 web.config 大概會長這樣：
&amp;lt;configuration&amp;gt; &amp;lt;system.webServer&amp;gt; &amp;lt;directoryBrowse enabled=&amp;#34;true&amp;#34; /&amp;gt; &amp;lt;modules runAllManagedModulesForAllRequests=&amp;#34;true&amp;#34; /&amp;gt; &amp;lt;/system.webServer&amp;gt; &amp;lt;/configuration&amp;gt; 參考資料：
How to enable Directory browsing by default on IIS Express</description></item></channel></rss>